<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stepik Bot - Telegram Mini App</title>
    
    <!-- Telegram WebApp API -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --tg-theme-bg-color: var(--tg-theme-bg-color, #ffffff);
            --tg-theme-text-color: var(--tg-theme-text-color, #000000);
            --tg-theme-button-color: var(--tg-theme-button-color, #007bff);
            --tg-theme-button-text-color: var(--tg-theme-button-text-color, #ffffff);
        }

        body {
            background: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .telegram-container {
            padding: 1rem;
            min-height: 100vh;
        }

        .telegram-card {
            background: var(--tg-theme-bg-color);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .telegram-button {
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            width: 100%;
            margin-bottom: 0.5rem;
            transition: opacity 0.2s;
        }

        .telegram-button:hover {
            opacity: 0.8;
        }

        .telegram-button:active {
            opacity: 0.6;
        }

        .telegram-secondary {
            background: transparent;
            color: var(--tg-theme-button-color);
            border: 1px solid var(--tg-theme-button-color);
        }

        .telegram-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-align: center;
        }

        .telegram-subtitle {
            font-size: 1rem;
            color: var(--tg-theme-text-color);
            opacity: 0.7;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .telegram-icon {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 1rem;
            color: var(--tg-theme-button-color);
        }

        .telegram-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .telegram-stat {
            text-align: center;
            padding: 1rem;
            background: rgba(0, 123, 255, 0.1);
            border-radius: 8px;
        }

        .telegram-stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--tg-theme-button-color);
        }

        .telegram-stat-label {
            font-size: 0.875rem;
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .telegram-form-group {
            margin-bottom: 1rem;
        }

        .telegram-form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .telegram-form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            background: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            font-size: 1rem;
        }

        .telegram-form-input:focus {
            outline: none;
            border-color: var(--tg-theme-button-color);
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }

        .telegram-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .telegram-table th,
        .telegram-table td {
            padding: 0.5rem;
            text-align: left;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .telegram-table th {
            font-weight: 600;
            background: rgba(0, 0, 0, 0.05);
        }

        .telegram-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .telegram-badge-success {
            background: #d4edda;
            color: #155724;
        }

        .telegram-badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .telegram-badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="telegram-container">
        <div class="telegram-card">
            <div class="telegram-icon">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h1 class="telegram-title">Stepik Bot</h1>
            <p class="telegram-subtitle">Система оценки тестов для студентов и преподавателей</p>
            
            <div class="telegram-stats">
                <div class="telegram-stat">
                    <div class="telegram-stat-number">0</div>
                    <div class="telegram-stat-label">Студентов</div>
                </div>
                <div class="telegram-stat">
                    <div class="telegram-stat-number">0</div>
                    <div class="telegram-stat-label">Тестов</div>
                </div>
            </div>
            
            <button class="telegram-button" onclick="window.location.href='/register'">
                <i class="fas fa-user-plus me-2"></i>
                Зарегистрироваться
            </button>
            
            <button class="telegram-button telegram-secondary" onclick="window.location.href='/'">
                <i class="fas fa-home me-2"></i>
                Главная страница
            </button>
        </div>
        
        <div class="telegram-card">
            <h3 class="telegram-title">Возможности</h3>
            <ul style="list-style: none; padding: 0;">
                <li style="margin-bottom: 0.5rem;">
                    <i class="fas fa-check-circle" style="color: #28a745; margin-right: 0.5rem;"></i>
                    Отправка тестов студентами
                </li>
                <li style="margin-bottom: 0.5rem;">
                    <i class="fas fa-check-circle" style="color: #28a745; margin-right: 0.5rem;"></i>
                    Оценка преподавателями
                </li>
                <li style="margin-bottom: 0.5rem;">
                    <i class="fas fa-check-circle" style="color: #28a745; margin-right: 0.5rem;"></i>
                    Статистика и прогресс
                </li>
                <li style="margin-bottom: 0.5rem;">
                    <i class="fas fa-check-circle" style="color: #28a745; margin-right: 0.5rem;"></i>
                    Мобильная версия
                </li>
            </ul>
        </div>
    </div>

    <script>
        // Инициализация Telegram WebApp
        if (window.Telegram && window.Telegram.WebApp) {
            const tg = window.Telegram.WebApp;
            
            // Расширяем приложение на весь экран
            tg.expand();
            
            // Настраиваем главную кнопку
            tg.MainButton.text = "Готово";
            tg.MainButton.color = "#007bff";
            tg.MainButton.textColor = "#ffffff";
            tg.MainButton.show();
            
            // Обработка главной кнопки
            tg.MainButton.onClick(function() {
                tg.close();
            });
            
            // Настраиваем цветовую схему
            if (tg.colorScheme) {
                document.documentElement.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color || '#ffffff');
                document.documentElement.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color || '#000000');
                document.documentElement.style.setProperty('--tg-theme-button-color', tg.themeParams.button_color || '#007bff');
                document.documentElement.style.setProperty('--tg-theme-button-text-color', tg.themeParams.button_text_color || '#ffffff');
            }
            
            // Логируем информацию о пользователе
            console.log('Telegram WebApp инициализирован');
            console.log('Пользователь:', tg.initDataUnsafe.user);
        }
        
        // Обработка нажатий кнопок
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('telegram-button')) {
                // Добавляем эффект нажатия
                e.target.style.opacity = '0.6';
                setTimeout(() => {
                    e.target.style.opacity = '1';
                }, 150);
            }
        });
    </script>
</body>
</html>
